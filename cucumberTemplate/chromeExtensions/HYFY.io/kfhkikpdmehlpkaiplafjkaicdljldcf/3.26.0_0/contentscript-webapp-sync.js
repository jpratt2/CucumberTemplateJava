"use strict";!function(){var a=window.logModule.getLogger("WebappSyncContentScript"),b=function(){a.debug("_attachMessageListener","entering"),chrome.runtime.onMessage.addListener(d)},c=function(){a.debug("_removeMessageListener","entering"),chrome.runtime.onMessage.removeListener(d)},d=function(b,c,d){var e=!1;switch(b.message){case window.constantsModule.JS_MESSAGES.DISABLE_CONTENT_SCRIPT:a.info("_messageListener","processing",b),h();break;case window.constantsModule.JS_MESSAGES.GET_SESSION_USER_DETAILS:a.info("_messageListener","processing",b),e=!0,f(function(a){d(a)})}return e},e=function(){a.debug("_init","entering"),b(),$(".js-user-logout a").click(g);var c=parseInt($('meta[name="current-time-in-millis"]').attr("content")),d=$('meta[name="auth0-account-logout"]').attr("content"),e=$('meta[name="auth0-auto-login"]').attr("content"),f=$('meta[name="user-subscriptions"]').attr("content"),h=$('meta[name="user-features"]').attr("content");if(d)BackgndAPI.removeUserAccount({timeInMillis:c});else{var i=$('meta[name="auth0-account-id"]').attr("content");if(i)BackgndAPI.setUserAccount({timeInMillis:c,accountId:i,subscriptions:f,features:h});else if(e){var j=$('meta[name="hyfy-client-account-ids"]').attr("content");j||window.clientUtilsModule.callApi({url:window.utilsModule.makeSiteUrl(window.urlsModule.SITE_API_URLS.create_session),type:"GET",success:function(){$(".js-processing").removeClass("hide"),location.reload()}},!0)}}},f=function(b){a.info("_fetchSessionUserAuthDetails","entering"),window.clientUtilsModule.callApi({url:window.utilsModule.makeSiteUrl(window.urlsModule.SITE_API_URLS.get_auth_details),type:"GET",success:function(c){a.debug("_fetchSessionUserAuthDetails","got auth details"),b(c)},error:function(){a.warn("_fetchSessionUserAuthDetails","auth details request failed!!"),b()}},!1)},g=function(a){a.preventDefault();var b=$(this).attr("href");BackgndAPI.isExtensionIdle({},function(a){void 0!==a&&0==a.status?BackgndAPI.showNotification({context:{notificationContext:window.constantsModule.NOTIFICATION_CONTEXT.BROWSER},notificationData:{notificationMessage:window.constantsModule.NOTIFICATION_MESSAGES.LOGOUT_DISABLED,expiryInSeconds:3}}):window.location=b})},h=function(){a.debug("_destroy","entering"),c(),$(".js-user-logout a").off("click")};$(document).ready(function(){e()})}();