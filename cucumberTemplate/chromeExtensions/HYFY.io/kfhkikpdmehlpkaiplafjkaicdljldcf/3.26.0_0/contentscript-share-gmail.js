!function(){var a=window.logModule.getLogger("ShareGmailContentScript"),b=void 0,c=void 0,d=window.EXTENSION_SETTINGS.siteBaseUrl,e=window.EXTENSION_SETTINGS.staticBaseUrl,f=void 0,g=void 0,h="",i="/images/default-thumbnail.jpg";a.debug("contentscript-share-gmail","executing");var j='<br><div>body_text</div><a href="play_url"> <table  style="background-image:url(thumbnail_url); height:188px; width:300px;border-collapse: collapse; margin-top:12px; background-size: contain; background-position: center; background-repeat: no-repeat;"><tr><td style="background-color:rgba(55,55,55,0.5);height:100%; width:100%;"><table  style="background:#ffffff;height:36px; width:36px;margin:auto;border-radius:50%;"><tr><td style="height:100%; width:100%;"><img style="width:12px;height:18px; margin-left:10px;margin-top:3px;" src="play_icon_url"></img></td></tr></table></td></tr></table></a><br><a href="play_url" style="text-decoration:none;color:#3EBBF7;font-family:Arial;font-size:14px;line-height:16px;padding-bottom:10px;">video_title</a>',k='<br><div>body_text</div><a href="play_url"><table style="height:188px; width:300px;border-collapse: collapse;margin-top:12px;"><tr style="border:1px solid rgb(231,231,231)"><td style="background-color:rgba(55,55,55,0.5);height:100%; width:100px;background-repeat: no-repeat;background-size:cover;background-position:center center;background-image:url(facecam_url)"></td><td style="background-color:rgba(55,55,55,0.5);height:100%; width:200px;background-repeat: no-repeat;background-size:cover;background-position:center center;background-image:url(thumbnail_url)"><table  style="background:#ffffff;height:36px; width:36px;margin:auto;border-radius:50%;margin-left:32px"><tr><td style="height:100%; width:100%;"><img style="width:12px;height:18px; margin-left:10px;margin-top:3px;" src="play_icon_url"></img></td></tr></table></td></tr></table></a><br><a href="play_url" style="text-decoration:none;color:#3EBBF7;font-family:Arial;font-size:14px;line-height:16px;padding-bottom:10px;">video_title</a><br>',l='<br><div>body_text</div><div><table style="height:188px; width:300px;border-collapse: collapse; margin-top:12px;"><tr><td style="height:100%; width:100%;"><img style="max-width: 1024px;" src=thumbnail_url></td></tr></table></div><br><div style="text-decoration:none;font-family:Arial;font-size:14px;line-height:16px;padding-bottom:10px;">video_title</div>',m=e+"/images/play-icon-pink-48x68.png";BackgndAPI.getCurrentTabUrl({},function(b){c=b.tabUrl,a.debug("got tab url",c);var e=decodeURIComponent(c),h=e.match("videos-gifs/HYFY-RECORDING-(.*?)-"),i=e.match(d+"/v/(.*?)/");i&&i.length>1?(f=i[1],g=window.urlsModule.API_URLS.videos.videoShareDetail,o()):h&&h.length>1?(f=h[1],g=window.urlsModule.API_URLS.videos.gifShareDetail,o()):a.info("failed to fetch video id from tab url",c)});var n=function(){a.info("_insertThumbnail","entering"),p(),$('.M9 div[contenteditable="true"]').length>0?BackgndAPI.fetchMailShareVideoDetail({videoId:f,url:g},function(b){if(a.info("Fetched video details",b),b&&b.thumbnailUrl&&b.videoUrl){$('.M9 div[contenteditable="true"]').html("");var c=b.thumbnailUrl;if(c.indexOf(i)>=0&&(c=e+i),c=encodeURIComponent(c),b.sourceType==window.constantsModule.VIDEO_SOURCE_TYPE.VIDEO){h="Hello, <br><br>I recorded a personalized video for you.<br>";var d;switch(b.playMode){case window.constantsModule.VIDEO_PLAY_MODE.FACECAM_AND_SCREEN:b.hasOwnProperty("screenGIFThumbnailUrl")&&b.hasOwnProperty("facecamGIFThumbnailUrl")&&b.facecamGIFThumbnailUrl&&b.screenGIFThumbnailUrl?(d=k.replace("facecam_url",b.facecamGIFThumbnailUrl),d=d.replace("thumbnail_url",b.screenGIFThumbnailUrl)):(d=k.replace("facecam_url",b.facecamThumbnailUrl),d=d.replace("thumbnail_url",b.thumbnailUrl));break;case window.constantsModule.VIDEO_PLAY_MODE.FACECAM:d=b.hasOwnProperty("facecamGIFThumbnailUrl")&&b.facecamGIFThumbnailUrl?j.replace("thumbnail_url",b.facecamGIFThumbnailUrl):j.replace("thumbnail_url",b.facecamThumbnailUrl);break;case window.constantsModule.VIDEO_PLAY_MODE.SCREEN:d=b.hasOwnProperty("screenGIFThumbnailUrl")&&b.screenGIFThumbnailUrl?j.replace("thumbnail_url",b.screenGIFThumbnailUrl):j.replace("thumbnail_url",b.thumbnailUrl)}d=d.replace("play_icon_url",m)}else{h="Hello, <br><br>I recorded a personalized GIF for you.<br>";var d=l.replace("thumbnail_url",b.thumbnailUrl)}d=d.replace("body_text",h),d=d.replace(/\play_url/g,b.videoUrl),d=b.titleEdited?d.replace("video_title",b.title):d.replace("video_title","");var f=$(d);$('.M9 div[contenteditable="true"]').append(f)}else a.debug("failed to fetch video detail")}):o()},o=function(){a.info("_setInsertThumbnailTimer","entering"),b=setTimeout(n,200)},p=function(){a.info("_clearInsertThumbnailTimer","entering"),b&&(clearTimeout(b),b=null)}}();